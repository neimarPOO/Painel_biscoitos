<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Projeto Biscoitos de Natal Escola StartUp</title>

    <!-- Material Design 3 -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Symbols+Outlined" rel="stylesheet">

    <!-- Custom Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Mountains+of+Christmas:wght@400;700&display=swap"
        rel="stylesheet">

    <!-- External Styles -->
    <link rel="stylesheet" href="css/styles.css">

    <script type="importmap">
        { "imports": { "@material/web/": "https://esm.run/@material/web/" } }
    </script>
    <script type="module">
        import '@material/web/all.js';
        import { styles as typescaleStyles } from '@material/web/typography/md-typescale-styles.js';
        document.adoptedStyleSheets.push(typescaleStyles.styleSheet);
    </script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>

    <div class="custom-navbar">
        <div class="navbar-left">

        </div>
        <div class="navbar-center">
            <span class="navbar-title">Projeto Biscoitos de Natal Escola StartUp</span>
            <span class="navbar-subtitle">Painel para organização das equipes</span>
        </div>
        <div class="navbar-right">
            <md-icon-button id="theme-toggle-btn">
                <md-icon>dark_mode</md-icon>
            </md-icon-button>
            <md-icon-button onclick="resetData()">
                <!-- Event listener attached in app.js, onclick attribute kept for reference but handled in JS -->
                <md-icon>restart_alt</md-icon>
            </md-icon-button>
        </div>
    </div>

    <md-tabs aria-label="Abas de conteúdo">
        <md-primary-tab id="tab-btn-cronograma" aria-controls="tab-cronograma">
            <md-icon slot="icon">task_alt</md-icon>
            Cronograma
        </md-primary-tab>
        <md-primary-tab id="tab-btn-custos" aria-controls="tab-custos">
            <md-icon slot="icon">calculate</md-icon>
            Calculadora
        </md-primary-tab>
    </md-tabs>

    <main class="main-content">
        <div id="tab-cronograma" class="tab-panel active">
            <div class="card">
                <div class="card-header">
                    <md-icon>groups</md-icon>
                    <h3>Equipe da Startup</h3>
                </div>
                <div class="flex gap-2 items-center">
                    <md-outlined-text-field label="Nome do integrante" id="new-member-name"
                        style="flex-grow: 1;"></md-outlined-text-field>
                    <md-filled-button onclick="addMember()">
                        <md-icon slot="icon">add</md-icon>
                        Adicionar
                    </md-filled-button>
                </div>
                <md-chip-set id="team-list" class="mt-4"></md-chip-set>
                <p id="no-members-msg" class="md-typescale-body-medium" style="color: var(--md-sys-color-outline);">
                    Adicione os integrantes para delegar tarefas.</p>

                <h4 class="md-typescale-title-medium" style="margin-top: 24px; margin-bottom: 8px;">Progresso Geral</h4>
                <div class="flex items-center gap-2">
                    <md-linear-progress id="overall-progress" value="0" style="flex-grow: 1;"></md-linear-progress>
                    <span id="progress-label" class="md-typescale-label-large">0%</span>
                </div>
            </div>

            <div id="timeline-container" class="timeline-grid"></div>
        </div>

        <div id="tab-custos" class="tab-panel">
            <div class="calculator-grid">
                <div class="flex" style="flex-direction: column; gap: 16px;">
                    <div class="card">
                        <div class="card-header">
                            <h3>Meta de Produção</h3>
                        </div>
                        <md-outlined-text-field id="meta-qtd" label="Meta de Quantidade" type="number" value="50"
                            suffix-text="unidades"></md-outlined-text-field>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h3>Ingredientes da Receita Base</h3>
                        </div>
                        <div id="ingredient-inputs"></div>
                        <md-text-button onclick="addIngredient()" style="margin-top: 16px;">
                            <md-icon slot="icon">add</md-icon>
                            Adicionar Ingrediente
                        </md-text-button>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h3>Custos Extras & Fixos</h3>
                        </div>
                        <div id="extra-costs-inputs"></div>
                        <md-text-button onclick="addExtraCost()" style="margin-top: 16px;">
                            <md-icon slot="icon">add</md-icon>
                            Adicionar Custo
                        </md-text-button>
                    </div>
                </div>

                <div class="card result-card">
                    <h3 class="md-typescale-title-large" style="text-align: center; margin-bottom: 16px;">Resultado</h3>

                    <div style="width: 100%; max-width: 400px; margin: 0 auto 24px;">
                        <canvas id="results-chart"></canvas>
                    </div>

                    <div class="grid" style="grid-template-columns: 1fr 1fr; gap: 8px;">
                        <div
                            style="background: var(--md-sys-color-primary-container); color: var(--md-sys-color-on-primary-container); padding: 8px; border-radius: 8px;">
                            <p class="md-typescale-label-medium">Custo Startup</p>
                            <p class="md-typescale-headline-small">R$ <span id="cost-startup">0.00</span></p>
                        </div>
                        <div
                            style="background: var(--md-sys-color-tertiary-container); color: var(--md-sys-color-on-tertiary-container); padding: 8px; border-radius: 8px;">
                            <p class="md-typescale-label-medium">Custo "De Casa"</p>
                            <p class="md-typescale-headline-small">R$ <span id="cost-own">0.00</span></p>
                        </div>
                    </div>
                    <hr style="margin: 16px 0; border-color: var(--md-sys-color-outline-variant);">
                    <div class="flex justify-between items-center">
                        <p class="md-typescale-body-large">Custo Unitário</p>
                        <p class="md-typescale-headline-medium">R$ <span id="unit-cost">0.00</span></p>
                    </div>
                    <hr style="margin: 16px 0; border-color: var(--md-sys-color-outline-variant);">

                    <label class="md-typescale-body-medium">Margem de Lucro: <span id="margin-display"
                            style="font-weight: bold;">50%</span></label>
                    <md-slider id="margin-slider" min="0" max="300" value="50" labeled ticks></md-slider>

                    <md-outlined-text-field id="units-per-package" label="Unidades por Pacote" type="number" value="6"
                        suffix-text="unidades" style="margin-top: 16px;"></md-outlined-text-field>

                    <div
                        style="background-color: var(--md-sys-color-primary); color: var(--md-sys-color-on-primary); padding: 16px; border-radius: 12px; text-align: center; margin-top: 16px;">
                        <p class="md-typescale-label-large">PREÇO DE VENDA</p>
                        <p class="md-typescale-display-small">R$ <span id="final-price">0.00</span> / unidade</p>
                        <p class="md-typescale-headline-small" style="margin-top: 8px;">R$ <span
                                id="package-price">0.00</span> / pacote</p>
                        <p class="md-typescale-body-medium" style="margin-top: 16px;">Lucro por unidade: R$ <span
                                id="profit-unit">0.00</span></p>
                        <p class="md-typescale-body-large" style="margin-top: 8px; font-weight: 500;">Lucro Líquido: R$
                            <span id="net-profit">0.00</span>
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer>
        <img src="logo_natal.png" alt="Logo" class="footer-logo">
        <p>&copy; 2025 - Projeto Biscoitos de Natal</p>
    </footer>

    <md-dialog id="task-dialog">
        <div slot="headline" id="dialog-title">Nova Tarefa</div>
        <form slot="content" id="task-form" method="dialog">
            <md-outlined-text-field label="Título da Tarefa" id="modal-task-title" required
                style="width: 100%; margin-bottom: 16px;"></md-outlined-text-field>
            <label for="modal-task-description" class="md-typescale-body-small">Descrição (Opcional)</label>
            <textarea id="modal-task-description" rows="4"
                style="width: 100%; margin-bottom: 16px; background-color: var(--md-sys-color-surface-container-highest); color: var(--md-sys-color-on-surface); border-radius: 4px; border: 1px solid var(--md-sys-color-outline); padding: 8px; font-family: 'Roboto', sans-serif;"></textarea>
            <md-outlined-select label="Quem é o responsável?" id="modal-task-assignee"
                style="width: 100%; margin-bottom: 16px;">
            </md-outlined-select>
            <div id="modal-status-wrapper" style="display: none;">
                <md-outlined-select label="Status" id="modal-task-status" style="width: 100%;">
                    <md-select-option value="todo">
                        <div slot="headline">A Fazer</div>
                    </md-select-option>
                    <md-select-option value="done">
                        <div slot="headline">Concluído</div>
                    </md-select-option>
                </md-outlined-select>
            </div>
        </form>
        <div slot="actions">
            <md-text-button form="task-form" value="cancel">Cancelar</md-text-button>
            <md-text-button form="task-form" value="save">Salvar</md-text-button>
        </div>
    </md-dialog>

    <md-dialog id="confirm-dialog">
        <div slot="headline" id="confirm-dialog-title"></div>
        <div slot="content" id="confirm-dialog-content"></div>
        <div slot="actions">
            <md-text-button id="confirm-dialog-cancel">Cancelar</md-text-button>
            <md-text-button id="confirm-dialog-confirm">Confirmar</md-text-button>
        </div>
    </md-dialog>

    <!-- Main Application Logic -->
    <script type="module" src="js/app.js"></script>
</body>

</html>